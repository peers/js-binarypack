/*! binarypack.min.js build:0.0.7, production. Copyright(c) 2012 Eric Zhang <eric@ericzhang.com> MIT Licensed */(function(e){function n(){this._pieces=[],this._parts=[]}function s(e){this.index=0,this.blob=e,this.length=e.size,this.reader=new FileReader,this.reader.onload=o,this.reader.obj=this,this.callbacks=[],this.backReferences=[],this.stringBuffer="",this.codeBuffer=0,this.sizeBuffer=[],this.keyBuffer=[],this.genericBuffer=undefined}function o(){this.obj.callbacks.pop().call(this.obj,this.result)}function u(e){this.callbacks.pop().call(this,(new Float32Array(e))[0])}function a(e){this.callbacks.pop().call(this,(new Float64Array(e))[0])}function f(e){this.callbacks.pop().call(this,(new Uint8Array(e))[0])}function l(e){this.callbacks.pop().call(this,(new Uint16Array(e))[0])}function c(e){this.callbacks.pop().call(this,(new Uint32Array(e))[0])}function h(e){this.callbacks.pop().call(this,(new Int8Array(e))[0])}function p(e){this.callbacks.pop().call(this,(new Int16Array(e))[0])}function d(e){this.callbacks.pop().call(this,(new Int32Array(e))[0])}function v(e){e=(new Uint8Array(e))[0];if(e==255){var t=this.stringBuffer;return this.stringBuffer="",this.codeBuffer=0,this.callbacks.pop().call(this,t)}if(e<128)return this.codeBuffer=0,this.stringBuffer+=String.fromCharCode(e),this.read(1,v);if(e<224)return this.codeBuffer=(e&63)<<6,this.read(1,m);if(e<240)return this.codeBuffer=(e&31)<<12,this.read(2,m);if(e<248)return this.codeBuffer=(e&15)<<18,this.read(3,m);if(e<252)return this.codeBuffer=(e&7)<<18,this.read(4,m);this.codeBuffer=(e&3)<<30,this.read(5,m)}function m(e){e=new Uint8Array(e);for(var t=0;t<e.length;t++)this.codeBuffer|=(e[t]&127)<<(e.length-1-t)*6;this.stringBuffer+=String.fromCharCode(this.codeBuffer),this.codeBuffer=0,this.read(1,v)}function g(e){e=(new Float64Array(e))[0],this.callbacks.pop().call(this,new Date(e))}function y(e){this.genericBuffer={type:e},this.callbacks.push(b),this.read(1,v)}function b(e){this.genericBuffer.name=e,this.callbacks.push(w),this.read(8,a)}function w(e){this.genericBuffer.date=e,this.unpack(E)}function E(e){var t=this.genericBuffer.name,n=this.genericBuffer.date,i=this.genericBuffer.type;this.genericBuffer=undefined;var s=this.blob.slice(this.index,this.index+=e,i);r?this.callbacks.pop().call(this,new File([s],t,{type:i,lastModified:n})):(s.name=t,s.lastModifiedDate=new Date(n),s.lastModified=n,this.callbacks.pop().call(this,s))}function S(e){this.genericBuffer=e,this.unpack(x)}function x(e){var t=this.genericBuffer;this.genericBuffer=undefined;var n=this.blob.slice(this.index,this.index+=e,t);this.callbacks.pop().call(this,n)}function T(e){this.read(e,N)}function N(e){this.callbacks.pop().call(this,e)}function C(e){this.genericBuffer={length:e},this.unpack(k)}function k(e){this.genericBuffer.offset=e,this.unpack(T)}function L(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Uint8Array(e,t,n))}function A(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Uint16Array(e,t,n/2))}function O(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Uint32Array(e,t,n/4))}function M(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Int8Array(e,t,n))}function _(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Int16Array(e,t,n/2))}function D(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Int32Array(e,t,n/4))}function P(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Float32Array(e,t,n/4))}function H(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new Float64Array(e,t,n/8))}function B(e){var t=this.genericBuffer.offset,n=this.genericBuffer.length;this.callbacks.pop().call(this,new DataView(e,t,n))}function j(e){this.callbacks.pop().call(this,this.backReferences[e])}function F(e){var t=[];t._index=0,this.backReferences.push(t),e>0?(this.sizeBuffer.push(e),this.unpack(I)):this.callbacks.pop().call(this,this.backReferences.pop())}function I(e){var t=this.backReferences[this.backReferences.length-1];e!=i&&(t[t._index]=e),t._index++,t._index==this.sizeBuffer[this.sizeBuffer.length-1]?(delete t._index,this.sizeBuffer.pop(),this.callbacks.pop().call(this,this.backReferences.pop())):this.unpack(I)}function q(e){this.backReferences.push({}),e>0?(this.sizeBuffer.push(e),this.callbacks.push(R),this.read(1,v)):this.callbacks.pop().call(this,this.backReferences.pop())}function R(e){this.keyBuffer.push(e),this.unpack(U)}function U(e){this.backReferences[this.backReferences.length-1][this.keyBuffer.pop()]=e,--this.sizeBuffer[this.sizeBuffer.length-1]==0?(this.sizeBuffer.pop(),this.callbacks.pop().call(this,this.backReferences.pop())):(this.callbacks.push(R),this.read(1,v))}function z(e){this.genericBuffer={hash:e},this.unpack(W)}function W(e){this.genericBuffer.start=e,e==0?this.unpack(X):this.unpack($)}function X(e){this.genericBuffer.metadata=e,this.unpack(V)}function V(e){this.genericBuffer.total=e,this.unpack($)}function $(e){var t=new Bt(this.blob.slice(this.index,this.index+=e-this.genericBuffer.start),this.genericBuffer.start,e,this.genericBuffer.hash,this.genericBuffer.metadata,this.genericBuffer.total);this.genericBuffer=undefined,this.callbacks.pop().call(this,t)}function J(e){e=(new Uint8Array(e))[0];if(e>=240)return this.callbacks.pop().call(this,e&15);if(e>=224)return this.callbacks.pop().call(this,-((e&14)+1));switch(e){case 0:return this.callbacks.pop().call(this,null);case 1:return this.callbacks.pop().call(this,undefined);case 2:return this.callbacks.pop().call(this,!1);case 3:return this.callbacks.pop().call(this,!0);case 4:return this.read(4,u);case 5:return this.read(8,a);case 6:return this.read(1,f);case 7:return this.read(2,l);case 8:return this.read(4,c);case 9:return this.read(1,h);case 10:return this.read(2,p);case 11:return this.read(4,d);case 12:return this.read(1,v);case 13:return this.read(8,g);case 14:return this.callbacks.push(y),this.read(1,v);case 15:return this.callbacks.push(S),this.read(1,v);case 16:return this.unpack(T);case 17:return this.callbacks.push(L),this.unpack(C);case 18:return this.callbacks.push(A),this.unpack(C);case 19:return this.callbacks.push(O),this.unpack(C);case 20:return this.callbacks.push(M),this.unpack(C);case 21:return this.callbacks.push(_),this.unpack(C);case 22:return this.callbacks.push(D),this.unpack(C);case 23:return this.callbacks.push(P),this.unpack(C);case 24:return this.callbacks.push(H),this.unpack(C);case 25:return this.callbacks.push(B),this.unpack(C);case 26:return this.unpack(j);case 27:return this.unpack(F);case 28:return this.unpack(q);case 29:return this.callbacks.pop().call(this,i);case 30:return this.unpack(z)}}function K(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength,this.backReferences=[]}function Q(){this.bufferBuilder=new n,this.backReferences=[]}function Z(e){return G.set(e),Y[0]}function et(e){return Y[0]=e,Y.buffer.slice(0)}function tt(e){return Y[0]=e,Y[0]}function it(e){return nt.set(e),rt[0]}function st(e){return rt[0]=e,rt.buffer.slice(0)}function ot(e){return rt[0]=e,rt[0]}function ft(e){return ut.set(e),at[0]}function lt(e){return at[0]=e,at.buffer.slice(0)}function ct(e){return at[0]=e,at[0]}function dt(e){return ht.set(e),pt[0]}function vt(e){return pt[0]=e,pt.buffer.slice(0)}function mt(e){return pt[0]=e,pt[0]}function bt(e){return gt.set(e),yt[0]}function wt(e){return yt[0]=e,yt.buffer.slice(0)}function Et(e){return yt[0]=e,yt[0]}function Tt(e){return St.set(e),xt[0]}function Nt(e){return xt[0]=e,xt.buffer.slice(0)}function Ct(e){return xt[0]=e,xt[0]}function At(e){return kt.set(e),Lt[0]}function Ot(e){return Lt[0]=e,Lt.buffer.slice(0)}function Mt(e){return Lt[0]=e,Lt[0]}function Dt(e){return _t.set(e),_t[0]}function Pt(e){return _t[0]=e,_t.buffer.slice(0)}function Ht(e){return _t[0]=e,_t[0]}function Bt(e,t,n,r,i,s){this.data=e,this.start=t,this.end=n,this.hash=r,this.total=s,this.metadata=i}function jt(e,t,n){this.blob=e,this.index=0,this.complete=0,this.hash=t,this.metadata=n}function Ft(){this.result=new Blob,this.index=0,this.complete=0,this.buffer={pointers:[],chunks:[]}}var t={};t.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),t.useArrayBufferView=!t.useBlobBuilder&&function(){try{return(new Blob([new Uint8Array([])])).size===0}catch(e){return!0}}(),e.binaryFeatures=t,e.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder,n.prototype.append=function(e){typeof e=="number"?this._pieces.push(e):(this.flush(),this._parts.push(e))},n.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);t.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},n.prototype.getBuffer=function(){this.flush();if(t.useBlobBuilder){var e=new BlobBuilder;for(var n=0,r=this._parts.length;n<r;n++)e.append(this._parts[n]);return e.getBlob()}return new Blob(this._parts)};var r=function(){try{new File(["foo"],"bar")}catch(e){return!1}return!0}(),i={};s.prototype.read=function(e,t){var n=this.blob.slice(this.index,this.index+=e);this.callbacks.push(t),this.reader.readAsArrayBuffer(n)},s.prototype.unpack=function(e){this.callbacks.push(e),this.read(1,J)},K.prototype.unpack=function(){var e=this.unpack_uint8();if(e>=240)return e&15;if(e>=224)return-((e&14)+1);switch(e){case 0:return null;case 1:return undefined;case 2:return!1;case 3:return!0;case 4:return this.unpack_float32();case 5:return this.unpack_float64();case 6:return this.unpack_uint8();case 7:return this.unpack_uint16();case 8:return this.unpack_uint32();case 9:return this.unpack_int8();case 10:return this.unpack_int16();case 11:return this.unpack_int32();case 12:return this.unpack_string();case 13:return this.unpack_date();case 14:return this.unpack_file();case 15:return this.unpack_blob();case 16:return this.unpack_raw(this.unpack());case 17:return this.unpack_uint8array();case 18:return this.unpack_uint16array();case 19:return this.unpack_uint32array();case 20:return this.unpack_int8array();case 21:return this.unpack_int16array();case 22:return this.unpack_int32array();case 23:return this.unpack_float32array();case 24:return this.unpack_float64array();case 25:return this.unpack_dataview();case 26:return this.backReferences[this.unpack()];case 27:return this.unpack_array();case 28:return this.unpack_map();case 29:return i;case 30:return this.unpack_chunk()}},K.prototype.unpack_uint8=function(){var e=this.read(1);return this.index++,Dt(e)},K.prototype.unpack_uint16=function(){var e=this.read(2);return this.index+=2,Tt(e)},K.prototype.unpack_uint32=function(){var e=this.read(4);return this.index+=4,dt(e)},K.prototype.unpack_int8=function(){var e=this.read(1);return this.index++,At(e)},K.prototype.unpack_int16=function(){var e=this.read(2);return this.index+=2,bt(e)},K.prototype.unpack_int32=function(){var e=this.read(4);return this.index+=4,ft(e)},K.prototype.unpack_float32=function(){var e=this.read(4);return this.index+=4,it(e)},K.prototype.unpack_float64=function(){var e=this.read(8);return this.index+=8,Z(e)},K.prototype.unpack_date=function(){var e=this.unpack_float64();return new Date(e)},K.prototype.unpack_file=function(){var e=this.unpack_string(),t=this.unpack_string(),n=this.unpack_float64(),i=this.unpack(),s=this.unpack_raw(i);if(r)return new File([s],t,{type:e,lastModified:n});var o=new Blob([s],{type:e});return o.name=t,o.lastModifiedDate=new Date(n),o.lastModified=n,o},K.prototype.unpack_blob=function(){var e=this.unpack_string(),t=this.unpack(),n=this.unpack_raw(t);return new Blob([n],{type:e})},K.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},K.prototype.unpack_uint8array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Uint8Array(n,t,e)},K.prototype.unpack_uint16array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Uint16Array(n,t,e/2)},K.prototype.unpack_uint32array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Uint32Array(n,t,e/4)},K.prototype.unpack_int8array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Int8Array(n,t,e)},K.prototype.unpack_int16array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Int16Array(n,t,e/2)},K.prototype.unpack_int32array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Int32Array(n,t,e/4)},K.prototype.unpack_float32array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Float32Array(n,t,e/4)},K.prototype.unpack_float64array=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new Float64Array(n,t,e/8)},K.prototype.unpack_dataview=function(){var e=this.unpack(),t=this.unpack(),n=this.unpack_raw(this.unpack());return new DataView(n,t,e)},K.prototype.unpack_string=function(){var e=this.index,t="",n;while(this.dataView[e]!=255){if(this.dataView[e]<128){t+=String.fromCharCode(this.dataView[e]),e++;continue}if(this.dataView[e]<224){n=(this.dataView[e]&63)<<6|this.dataView[e+1]&127,t+=String.fromCharCode(n),e+=2;continue}if(this.dataView[e]<240){n=(this.dataView[e]&31)<<12|(this.dataView[e+1]&127)<<6|this.dataView[e+2]&127,t+=String.fromCharCode(n),e+=3;continue}if(this.dataView[e]<248){n=(this.dataView[e]&15)<<18|(this.dataView[e+1]&127)<<12|(this.dataView[e+1]&127)<<6|this.dataView[e+3]&127,t+=String.fromCharCode(n),e+=4;continue}if(this.dataView[e]<252){n=(this.dataView[e]&7)<<24|(this.dataView[e+1]&127)<<18|(this.dataView[e+2]&127)<<12|(this.dataView[e+3]&127)<<6|this.dataView[e+4]&127,t+=String.fromCharCode(n),e+=5;continue}n=(this.dataView[e+1]&3)<<30|(this.dataView[e]&127)<<24|(this.dataView[e+2]&127)<<18|(this.dataView[e+3]&127)<<12|(this.dataView[e+4]&127)<<6|this.dataView[e+5]&127,t+=String.fromCharCode(n),e+=6}return this.index=e+1,t},K.prototype.unpack_array=function(){var e=this.unpack(),t=[],n;this.backReferences.push(t);for(var r=0;r<e;r++)n=this.unpack(),n!=i&&(t[r]=n);return this.backReferences.pop(),t},K.prototype.unpack_map=function(){var e={},t=this.unpack();this.backReferences.push(e);for(var n=0;n<t;n++){var r=this.unpack_string(),i=this.unpack();e[r]=i}return this.backReferences.pop(),e},K.prototype.unpack_chunk=function(){var e=this.unpack(),t=this.unpack(),n,r,i,s;return t==0&&(n=this.unpack(),r=this.unpack()),i=this.unpack(),s=this.unpack_raw(i-t),new Bt(s,t,i,e,n,r)},K.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},Q.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},Q.prototype.pack=function(e){switch(typeof e){case"string":this.pack_string(e);break;case"number":mt(e)===e||ct(e)===e?this.pack_integer(e):this.pack_double(e);break;case"boolean":e?this.bufferBuilder.append(Pt(3)):this.bufferBuilder.append(Pt(2));break;case"undefined":this.bufferBuilder.append(Pt(1));break;case"object":if(e!==null)return typeof e.toBinaryPack=="function"?this.bufferBuilder.append(e.toBinaryPack()):e.constructor==Object?this.pack_object(e):e instanceof Array?this.pack_array(e):e instanceof Date?this.pack_date(e):e instanceof Bt?this.pack_chunk(e):e instanceof Blob?e instanceof File?this.pack_file(e):this.pack_blob(e):e instanceof ArrayBuffer?this.pack_buffer(e):e.buffer instanceof ArrayBuffer?e instanceof Uint8Array?this.pack_uint8array(e):e instanceof Uint16Array?this.pack_uint16array(e):e instanceof Uint32Array?this.pack_uint32array(e):e instanceof Int8Array?this.pack_int8array(e):e instanceof Int16Array?this.pack_int16array(e):e instanceof Int32Array?this.pack_int32array(e):e instanceof Float32Array?this.pack_float32array(e):e instanceof Float64Array?this.pack_float64array(e):e instanceof DataView?this.pack_dataview(e):this.pack_object(e):this.pack_object(e);this.bufferBuilder.append(Pt(0))}},Q.prototype.pack_date=function(e){this.bufferBuilder.append(Pt(13)),this.pack_raw_date(e)},Q.prototype.pack_raw_date=function(e){var t=e.valueOf();this.pack_float64(t)},Q.prototype.pack_file=function(e){this.bufferBuilder.append(Pt(14)),this.pack_raw_string(e.type),this.pack_raw_string(e.name),e.lastModifiedDate?this.pack_raw_date(e.lastModifiedDate):this.pack_float64(e.lastModified),this.pack(e.size),this.bufferBuilder.append(e)},Q.prototype.pack_blob=function(e){this.bufferBuilder.append(Pt(15)),this.pack_raw_string(e.type),this.pack(e.size),this.bufferBuilder.append(e)},Q.prototype.pack_buffer=function(e){this.bufferBuilder.append(Pt(16)),this.pack_raw_buffer(e)},Q.prototype.pack_raw_buffer=function(e){this.pack(e.byteLength),this.bufferBuilder.append(e)},Q.prototype.pack_raw_bufferview=function(e){this.pack(e.byteLength),this.pack(e.byteOffset),this.pack_raw_buffer(e.buffer)},Q.prototype.pack_uint8array=function(e){this.bufferBuilder.append(Pt(17)),this.pack_raw_bufferview(e)},Q.prototype.pack_uint16array=function(e){this.bufferBuilder.append(Pt(18)),this.pack_raw_bufferview(e)},Q.prototype.pack_uint32array=function(e){this.bufferBuilder.append(Pt(19)),this.pack_raw_bufferview(e)},Q.prototype.pack_int8array=function(e){this.bufferBuilder.append(Pt(20)),this.pack_raw_bufferview(e)},Q.prototype.pack_int16array=function(e){this.bufferBuilder.append(Pt(21)),this.pack_raw_bufferview(e)},Q.prototype.pack_int32array=function(e){this.bufferBuilder.append(Pt(22)),this.pack_raw_bufferview(e)},Q.prototype.pack_float32array=function(e){this.bufferBuilder.append(Pt(23)),this.pack_raw_bufferview(e)},Q.prototype.pack_float64array=function(e){this.bufferBuilder.append(Pt(24)),this.pack_raw_bufferview(e)},Q.prototype.pack_dataview=function(e){this.bufferBuilder.append(Pt(25)),this.pack_raw_bufferview(e)},Q.prototype.pack_string=function(e){this.bufferBuilder.append(Pt(12)),this.pack_raw_string(e)},Q.prototype.pack_raw_string=function(e){this.bufferBuilder.append(e),this.bufferBuilder.append(Pt(255))},Q.prototype.pack_array=function(e){this.bufferBuilder.append(Pt(27)),this.pack(e.length),this.backReferences.push(e);var t;for(var n=0;n<e.length;n++){if(!(n in e)){this.bufferBuilder.append(Pt(29));continue}if((t=this.backReferences.indexOf(e[n]))!=-1){this.bufferBuilder.append(Pt(26)),this.pack(t);continue}this.pack(e[n])}this.backReferences.pop()},Q.prototype.pack_object=function(e){this.bufferBuilder.append(Pt(28)),this.pack_raw_object(e)},Q.prototype.pack_raw_object=function(e){this.pack(Object.keys(e).length),this.backReferences.push(e);var t;for(var n in e){if(!e.hasOwnProperty(n))continue;this.pack_raw_string(n);if((t=this.backReferences.indexOf(e[n]))!=-1){this.bufferBuilder.append(Pt(26)),this.pack(t);continue}this.pack(e[n])}this.backReferences.pop()},Q.prototype.pack_integer=function(e){e>=0?e<=15?this.bufferBuilder.append(Pt(240|e)):Ht(e)==e?(this.bufferBuilder.append(Pt(6)),this.bufferBuilder.append(Pt(e))):Ct(e)==e?(this.bufferBuilder.append(Pt(7)),this.bufferBuilder.append(Nt(e))):mt(e)==e&&(this.bufferBuilder.append(Pt(8)),this.bufferBuilder.append(vt(e))):e>=-16?(e=-e-1,this.bufferBuilder.append(Pt(224|e))):Mt(e)==e?(this.bufferBuilder.append(Pt(9)),this.bufferBuilder.append(Ot(e))):Et(e)==e?(this.bufferBuilder.append(Pt(10)),this.bufferBuilder.append(wt(e))):ct(e)==e&&(this.bufferBuilder.append(Pt(11)),this.bufferBuilder.append(lt(e)))},Q.prototype.pack_double=function(e){ot(e)==e?(this.bufferBuilder.append(Pt(4)),this.pack_float32(e)):(this.bufferBuilder.append(Pt(5)),this.pack_float64(e))},Q.prototype.pack_uint8=function(e){this.bufferBuilder.append(uInt8ToBuffer(e))},Q.prototype.pack_uint16=function(e){this.bufferBuilder.append(uInt16ToBuffer(e))},Q.prototype.pack_uint32=function(e){this.bufferBuilder.append(uInt32ToBuffer(e))},Q.prototype.pack_int8=function(e){this.bufferBuilder.append(Ot(e))},Q.prototype.pack_int16=function(e){this.bufferBuilder.append(wt(e))},Q.prototype.pack_int32=function(e){this.bufferBuilder.append(lt(e))},Q.prototype.pack_float32=function(e){this.bufferBuilder.append(st(e))},Q.prototype.pack_float64=function(e){this.bufferBuilder.append(et(e))},Q.prototype.pack_chunk=function(e){this.bufferBuilder.append(Pt(30)),this.pack(e.hash),this.pack(e.start);if(e.start==0){var t=new Q;t.pack(e.metadata);var n=t.getBuffer();n.size>500?(console.warn("Warning: chunk metadata too large"),this.pack(undefined)):this.bufferBuilder.append(n),this.pack(e.total)}this.pack(e.end),this.bufferBuilder.append(e.data)};var G=new Uint8Array(8),Y=new Float64Array(G.buffer),nt=new Uint8Array(4),rt=new Float32Array(nt.buffer),ut=new Uint8Array(4),at=new Int32Array(ut.buffer),ht=new Uint8Array(4),pt=new Uint32Array(ht.buffer),gt=new Uint8Array(2),yt=new Int16Array(gt.buffer),St=new Uint8Array(2),xt=new Uint16Array(St.buffer),kt=new Uint8Array(1),Lt=new Int8Array(kt.buffer),_t=new Uint8Array(1);jt.prototype.getNextChunk=function(e){if(this.complete>=1)return!1;var t=this.index,n=this.blob.slice(this.index,this.index=Math.min(this.blob.size,this.index+e));return this.complete=this.index/this.blob.size,new Bt(n,t,this.index,this.hash,this.metadata,this.blob.size)},Ft.prototype.addChunk=function(e){if(this.complete>=1)return!1;e.start==0&&(this.total=e.total,this.metadata=e.metadata);if(e.start!=this.index)return this.buffer.pointers.push(e.start),this.buffer.chunks.push(e),!0;this.result=new Blob([this.result,e.data]),this.index=e.end,this.complete=this.index/this.total;var t;if((t=this.buffer.pointers.indexOf(this.index))!=-1){this.buffer.pointers.splice(t,1);var n=this.buffer.chunks.splice(t,1)[0];return this.addChunk(n)}return!0},e.BinaryPack={Chunker:jt,Joiner:Ft,isChunk:function(e){return e instanceof Bt},unpack:function(e){var t=new K(e);return t.unpack()},blobUnpack:function(e,t){if(e.size>this.maxSize){var n=new s(e);return n.unpack(t)}var r=new FileReader;r.onload=function(){var n=new K(e);t.call(n,n.unpack())}},maxSize:1e4,pack:function(e){var t=new Q;t.pack(e);var n=t.getBuffer();return n}}})(this)